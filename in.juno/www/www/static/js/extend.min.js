function sprintf(){var c,d,a=arguments,b=a[0]||"";for(c=1,d=a.length;d>c;c++)b=b.replace(/%s/,a[c]);return b}!function(a){a.fn.extend({phone_switch:function(b){function f(){c.animate({marginLeft:-d},1e3,function(){a(this).css({marginLeft:"0px"}).find("li:first").appendTo(this)})}var c=a("#"+b),d=c.find("li").outerWidth(!0),e=d*c.find("li").length;if(c.width(e),c.find("li").length>1)var g=setInterval(f,4e3);c.hover(function(){g&&clearInterval(g)},function(){clearInterval(g),g=setInterval(f,4e3)})},is_empty:function(){var b=a(this).first();return b.val()?!1:(b.focus(),!0)},charCount:function(b){return this.each(function(){function g(){var a=c.val(),b=a.length;if(b>=d.maxChars&&(a=a.substring(0,d.maxChars)),b>d.maxChars){var f=c.scrollTop();c.val(a.substring(0,d.maxChars)),c.scrollTop(f)}b>=d.maxCharsWarning?e.css({color:d.msgWarningColor}):e.css({color:d.msgFontColor}),html="prepend"==d.msgPlacement?d.msg+d.numFormat:d.numFormat+d.msg,html=html.replace("CURRENT",c.val().length),html=html.replace("MAX",d.maxChars),html=html.replace("REMAINING",d.maxChars-c.val().length),e.html(html),e.stop().fadeTo("fast",1)}var c=a(this),d=a.extend({maxChars:140,maxCharsWarning:130,msgFontSize:"12px",msgFontColor:"#aaa",msgFontFamily:"Arial",msgTextAlign:"left",msgWarningColor:"#e44443",msgAppendMethod:"insertAfter",msg:"\u8fd8\u53ef\u4ee5\u8f93\u5165\uff1a",msgPlacement:"prepend",numFormat:"CURRENT/MAX"},b);if(!(0>=d.maxChars)){var e=a('<div class="jqEasyCounterMsg">&nbsp;</div>'),f={"font-size":d.msgFontSize,"font-family":d.msgFontFamily,color:d.msgFontColor,"text-align":d.msgTextAlign,width:"140px",opacity:0,display:"inline-block"};e.css(f),e[d.msgAppendMethod](c),c.bind("keydown keyup keypress",g).bind("focus paste",function(){setTimeout(g,10)}).bind("blur",function(){return e.stop().fadeTo("fast",0),!1})}})},plus:function(b){var c=a(this);if(""==c.first().html())c.each(function(){a(this).html("("+b+")")});else{var d=parseInt(c.first().html().replace("(","").replace(")",""));c.each(function(){a(this).html("("+(d+b)+")")})}}}),a.extend({checkAuth:function(){return"undefined"==typeof online_id||null===online_id||0===online_id||""===online_id?(a(".modal.in").modal("hide"),a("#modal").modal({remote:"/web/index"}),!1):!0},padNum:function(a,b){for(var c=(""+a).length;b>c;)a="0"+a,c++;return a},messager:function(b,c,d){if(!b)return!1;var e=a('<div id="messager"></div>');a("body").append(e),e.html(b);var f=a(document).scrollTop(),g=a(window).height(),h=a(window).width(),i=e.outerHeight(),j=e.outerWidth(),k=(g-i)/2+f,l=(h-j)/2;e.css({top:k+10,left:l,opacity:"0"}).animate({opacity:"1",top:k,queue:!0},200).delay("2000").animate({opacity:"0",top:k+10,queue:!0},200,function(){e.remove(),c&&("reload"==c?window.location.reload():window.location.href=c),d&&d()})},returntop:function(){var b=a('<div id="returntop"></div>');a("body").append(b);var c=b.click(function(){a("html, body").animate({scrollTop:0},120)});a(window).on("scroll",function(){var b=a(document).scrollTop();a(window).height(),b>200?c.fadeIn():c.fadeOut()})},modalSignin:function(){return a(".modal.in").modal("hide"),a("#modal").modal({remote:"/web/index"}),!1},modalSignup:function(){return a(".modal.in").modal("hide"),a("#modal").modal({remote:"/web/index"}),!1},signout:function(){a.ajax({type:"GET",url:signout_url,dataType:"jsonp",jsonpCallback:"callback",success:function(b){a.getScript(sso_logout_url,function(){a.messager(b.message,"reload")})}})}})}(window.jQuery),$(function(){$(".site-nav").lavaLamp({speed:400}),$('[rel="popover"]').popover(),$('[rel="tooltip"]').tooltip(),$("[placeholder]").placeholder(),$("#modal").on("shown",function(){var a=$(this);a.find("#signup-modal-form input[type!=submit]").each(function(){$(this).val("")}),a.find("#signin-modal-form input[type!=submit]").each(function(){$(this).val("")}),a.find("#signup-modal-form .caption p").removeClass("error").text("\u6ca1\u6709IN\u6210\u90fd\u5e10\u53f7\uff1f5\u79d2\u949f\u6025\u901f\u6ce8\u518c\u3002"),a.find("#signin-modal-form .caption p").removeClass("error").text("\u5df2\u6709IN\u6210\u90fd\u5e10\u53f7\uff0c\u8bf7\u767b\u5f55\u3002")}),$(".timeline").delegate(".post","mouseover",function(){$(this).find(".link").fadeIn()}),$(".timeline").delegate(".post","mouseleave",function(){$(this).find(".link").fadeOut()}),$(".timeline").delegate(".reply-form","focusin",function(){if(!$.checkAuth())return!1;var a=$(this);a.find(".btn").fadeIn()}),$(".timeline").delegate(".reply-form","focusout",function(){var a=$(this);""==a.find(".txt").val()&&$(this).find(".btn").hide()}),$(".timeline").delegate(".reply-form .btn","click",function(){$(this).parent("form").trigger("submit")}),$(".timeline").delegate(".photo img","click",function(){$(this).parent(".photo").toggleClass("on")}),$("html").delegate(".reply-form","submit",function(a){if(!$.checkAuth())return!1;var b=$(this),c=b.find("input").val();b.find("input").val("").attr("placeholder","\u56de\u590d\u5185\u5bb9...").trigger("blur"),$.ajax({type:"POST",url:"/common/reply",data:{id:b.data("id"),uid:b.data("uid"),content:encodeURIComponent(c),type:b.data("type")},dataType:"json",cache:!1,success:function(a){if(a.code>0)$.messager(a.msg);else{var d="";"reply"==b.data("type")&&(d='\u56de\u590d<a href="/user/'+b.data("uid")+'" target="_blank" class="name">'+b.data("user")+"</a>"),b.siblings(".reply-list").prepend('						<li>							<a href="/user/'+online_id+'" class="avatar"><img src="'+online_avatar+'"></a>							<p><a href="/user/'+online_id+'" class="name">'+online_name+"</a>"+d+"\uff1a"+c+'<br/><span class="time">\u521a\u521a</span></p>						</li>						'),"reply"==b.data("type")&&(b.data("type",b.closest(".post").data("type")),b.data("user",""),b.data("id",b.closest(".post").data("id"))),$("#reply_count_"+b.data("id")).plus(1)}}}),a.preventDefault()}),$("html").delegate(".reply-list .action-replyto","click",function(){if(!$.checkAuth())return!1;var a=$(this),b=a.closest(".reply-list").prev(".reply-form");return b.data("id",a.data("id")),b.data("uid",a.data("uid")),b.data("type","reply"),b.data("user",a.data("user")),b.find("input").attr("placeholder","\u56de\u590d "+a.data("user")).focus(),!1}),$("html").delegate(".action-reply","click",function(){var a=$(this);return $replys=a.closest(".footbar").next(".replys"),$replys.toggleClass("hide"),$(".channel-nav").affix("refresh"),$(".timeline-nav").affix("refresh"),!1}),$("html").delegate(".action-like","click",function(){if(!$.checkAuth())return!1;var a=$(this);return $.ajax({type:"POST",url:"/common/praise",data:{id:a.data("id"),uid:online_id,type:a.data("type")},dataType:"json",cache:!1,success:function(b){b.code>0?$.messager(b.msg):($.messager(b.msg),$("#praise_count_"+a.data("id")).plus(1),a.addClass("on"))}}),!1}),$("html").delegate(".action-share-weibo,.action-share-qq,.action-share-icd","click",function(){if(!$.checkAuth())return!1;var a=$(this),b=a.closest(".action-share"),c=$("#share-form");c.data("s",a.data("s")),c.data("type",b.data("type")),c.data("id",b.data("id")),c.find("textarea").val(a.data("content")),c.modal("show")}),$("#share-form").on("submit",function(){var a=$(this),b=a.find("input[type=submit]");return b.button("loading"),$.ajax({type:"POST",url:"/common/share",data:{id:a.data("id"),uid:online_id,s:a.data("s"),type:a.data("type"),content:a.find("textarea").val()},dataType:"json",cache:!1,success:function(c){if(4502==c.code||4506==c.code){var d=confirm("\u5206\u4eab\u5230\u5fae\u535a\u9700\u8981\u4f60\u7ed1\u5b9a\u4f60\u7684\u5fae\u535a\u8d26\u53f7\uff0c\u73b0\u5728\u53bb\u7ed1\u5b9a\uff1f");d&&(window.location.href="/profile/sync/")}else c.code>0?$.messager(c.msg):($.messager(c.msg),a.modal("hide"),$("#share_count_"+a.data("id")).plus(1));b.button("reset")}}),!1}),$("html").delegate(".action-favorite","click",function(){if(!$.checkAuth())return!1;var a=$(this);$.ajax({type:"POST",url:"/common/favorite",data:{id:a.data("id"),uid:online_id,type:a.data("type")},dataType:"json",cache:!1,success:function(b){b.code>0?$.messager(b.msg):($("#favorite_count_"+a.data("id")).plus(1),a.addClass("on").off())}})}),$('.action-follow[disabled!="disabled"]').live("click",function(){if(!$.checkAuth())return!1;var a=$(this);a.button("loading"),$.ajax({type:"POST",url:"/user_follow/"+a.data("uid"),dataType:"json",success:function(b){0==b.code?(a.button("reset"),$.messager(b.msg),a.text("\u53d6\u6d88\u5173\u6ce8").data("loading-text","\u53d6\u6d88\u4e2d...").removeClass("action-follow").addClass("action-unfollow")):1==b.code?$.modalSignin():(-1==b.code||-2==b.code)&&($.messager(b.msg),a.hide(),a.parent(".link-sj").hide())}})}),$('.action-unfollow[disabled!="disabled"]').live("click",function(){if(!$.checkAuth())return!1;var a=$(this);a.button("loading"),$.ajax({type:"POST",url:"/user_unfollow/"+a.data("uid"),dataType:"json",success:function(b){0==b.code?(a.button("reset"),$.messager(b.msg),a.text("\u52a0\u5173\u6ce8").data("loading-text","\u5173\u6ce8\u4e2d...").removeClass("action-unfollow").addClass("action-follow")):1==b.code?$.modalSignin():(-1==b.code||-2==b.code)&&($.messager(b.msg),a.hide(),a.parent(".link-sj").hide())}})}),$(".message_input textarea").charCount()});