$(function(){$.validator.addMethod("validpassword",function(a,b){return this.optional(b)||/^[a-zA-Z0-9_\`\~\!\@\#\$\%\^\&\*\(\)\-\=\+\[\]\{\}\\\|\;\:\'\"\<\>\,\.\/\?]{2,15}$/.test(a)},"Password Error."),$.validator.addMethod("validcellphone",function(a,b){return this.optional(b)||/^(1(([35][0-9])|(47)|[8][01236789]))\d{8}$/.test(a)},"Cellphone Error."),$.validator.addMethod("checktaboo",function(a){var c=!1;return $.ajax({type:"POST",url:"/common/check_taboo/",data:{content:a},async:!1,cache:!1,dataType:"json",success:function(a){0==a.code&&(c=!0)}}),c}),$("#user-settings-form").validate({rules:{nickname:{checktaboo:!0},description:{checktaboo:!0},tel:{validcellphone:!0}},messages:{nickname:{checktaboo:"\u6635\u79f0\u5305\u542b\u4e0d\u9002\u5b9c\u5185\u5bb9\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"},description:{checktaboo:"\u7b7e\u540d\u5305\u542b\u4e0d\u9002\u5b9c\u5185\u5bb9\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"},tel:{validcellphone:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801"}},highlight:function(a){"radio"===a.type?this.findByName(a.name).closest(".control-group").removeClass("valid success valid").addClass("error"):$(a).closest(".control-group").removeClass("valid success valid").addClass("error")},unhighlight:function(a){"radio"===a.type?this.findByName(a.name).closest(".control-group").removeClass("error success valid").addClass("valid"):$(a).closest(".control-group").removeClass("error success valid").addClass("valid")},success:function(a){"radio"===a.type?this.findByName(a.name).closest(".control-group").removeClass("error success valid").addClass("success"):$(a).closest(".control-group").removeClass("error success valid").addClass("success")},submitHandler:function(a){var b=$(a).find("input[type=submit]");return b.button("loading"),$.ajax({type:"POST",url:$(a).attr("action"),data:$(a).serialize(),dataType:"json",complete:function(){b.button("reset")},success:function(a){$.getScript("/sso"),$.messager(a.msg,"reload"),b.button("reset")}}),!1}}),$("#email-form").validate({rules:{password:{required:!0},email:{required:!0,email:!0}},message:{password:{required:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801"},email:{required:"\u8bf7\u8f93\u5165\u90ae\u7bb1\u5730\u5740",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1\u5730\u5740"}},highlight:function(a){"radio"===a.type?this.findByName(a.name).closest(".control-group").removeClass("valid success valid").addClass("error"):$(a).closest(".control-group").removeClass("valid success valid").addClass("error")},unhighlight:function(a){"radio"===a.type?this.findByName(a.name).closest(".control-group").removeClass("error success valid").addClass("valid"):$(a).closest(".control-group").removeClass("error success valid").addClass("valid")},success:function(a){"radio"===a.type?this.findByName(a.name).closest(".control-group").removeClass("error success valid").addClass("success"):$(a).closest(".control-group").removeClass("error success valid").addClass("success")},submitHandler:function(a){var b=$(a).find("input[type=submit]");return b.button("loading"),$.ajax({type:"POST",url:$(a).attr("action"),data:$(a).serialize(),dataType:"json",success:function(a){1==a.code?($.messager(a.msg),b.button("reset")):($.messager(a.msg),b.button("reset"))}}),!1}}),$("#revisepassword-form").validate({rules:{oldpwd:{required:!0},newpwd:{required:!0,validpassword:!0},renew:{required:!0,equalTo:"#newpwd"}},messages:{oldpwd:{required:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801",validpassword:"\u5bc6\u7801\u8f93\u5165\u82f1\u6587\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\uff0c\u957f\u5ea6\u57282~15\u4f4d\u4e4b\u95f4\uff0c\u533a\u5206\u5927\u5c0f\u5199\u3002"},newpwd:{required:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801",validpassword:"\u5bc6\u7801\u8f93\u5165\u82f1\u6587\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\uff0c\u957f\u5ea6\u57282~15\u4f4d\u4e4b\u95f4\uff0c\u533a\u5206\u5927\u5c0f\u5199\u3002"},renew:{required:"\u8bf7\u518d\u6b21\u8f93\u5165\u65b0\u5bc6\u7801",equalTo:"\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4"}},highlight:function(a){"radio"===a.type?this.findByName(a.name).closest(".control-group").removeClass("valid success valid").addClass("error"):$(a).closest(".control-group").removeClass("valid success valid").addClass("error")},unhighlight:function(a){"radio"===a.type?this.findByName(a.name).closest(".control-group").removeClass("error success valid").addClass("valid"):$(a).closest(".control-group").removeClass("error success valid").addClass("valid")},success:function(a){"radio"===a.type?this.findByName(a.name).closest(".control-group").removeClass("error success valid").addClass("success"):$(a).closest(".control-group").removeClass("error success valid").addClass("success")},submitHandler:function(a){var b=$(a).find("input[type=submit]");return b.button("loading"),$.ajax({type:"POST",url:$(a).attr("action"),data:$(a).serialize(),dataType:"json",success:function(a){1==a.code?($.messager(a.msg),b.button("reset")):0==a.code?$.ajax({type:"GET",url:signout_url,dataType:"jsonp",jsonpCallback:"callback",success:function(){$.getScript(sso_logout_url,function(){$.messager("\u5bc6\u7801\u4fdd\u5b58\u6210\u529f\u8bf7\u91cd\u65b0\u767b\u9646","/")})}}):2==a.code?($.messager(a.msg),b.button("reset")):-1==a.code&&$.messager(a.msg)}}),!1}})});