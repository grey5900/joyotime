function search(){var o=$("#search_form").attr("action"),u=$("#cid").val(),f=$("#s_cid").val(),n=$("input[name=star]").val(),t=$("#pcc").val(),r=$("#order").val(),i=$("#keyword").val(),e="",c=0,h=0,s=0;u==""&&(u="0"),f==""&&(f="0"),n==""&&(n="0"),t==""&&(t="F"),r==""&&(r="default"),i!=""&&i!="输入您想找的地点名，如麦当劳"&&(e=i+"/"),o+=u+"/"+f+"/"+n+"/"+t+"/"+c+"/"+h+"/"+s+"/"+r+"/"+e,window.location.href=o}function addOptions(n,t){var r=n.innerHTML,u=$(n).parent().parent().attr("id"),i=null;return t=="cid"?(i=$(n).attr("data-cid"),$("#cid").val(i),$("#s_cid").val("0"),show_son($(n).attr("data-cid"))):t=="s_cid"?($("#cid").val("0"),i=$(n).attr("data-cid"),$("#s_cid").val(i)):t=="star"?(i=$(n).attr("data-star"),$("#order").val("star"),$("#star").val($(n).attr("data-star"))):t=="pcc"?(i=$(n).attr("data-pcc"),$("#order").val("pcc"),$("#pcc").val($(n).attr("data-pcc"))):t=="order"&&(i=$(n).attr("data-order"),$("#order").val($(n).attr("data-order"))),search(),!1}function delOptions(n,t){var r=$(n).attr("data"),u=$("<li></li>"),i=$("<a onclick='addOptions(this, '"+t+"');'></a>");return i.attr("data-"+t,r),i.append($("<em></em>").html($(n).find("em").html())),u.append(i),t=="cid"?$("#cid").val(""):t=="s_cid"?$("#s_cid").val(""):t=="star"?$("input[name=star]").val(""):t=="pcc"?($("#pcc").val("F"),$("#order").val("default")):t=="order"?$("#order").val("default"):t=="keyword"&&$("#keyword").val(""),search(),!1}function show_son(n){$.ajax({type:"get",url:"/list_son/"+n+"/",dataType:"json",success:function(t){if(t!=null&&t!=""){var i=$('<ul clsss="second"></ul>');$.each(t,function(n,t){var r=$('<li id="cate-'+t.id+'"></li>'),u=$("<a onclick='addOptions(this,\"s_cid\");' data-cid='"+t.id+"'>"+t.content+"</a>");r.append(u),i.append(r)}),$("#cate-"+n).append(i)}}})}$(function(){$("#star_selector").raty({score:function(){return $(this).attr("data-rating")},scoreName:"star",hints:["一星","两星","三星","四星","五星"],size:36,space:!1,starOn:"star-large-on.png",starOff:"star-large-off.png",click:function(){search()}});$("#add-poi .btn").on("click",function(){return $.is_signin()?!0:!1})})