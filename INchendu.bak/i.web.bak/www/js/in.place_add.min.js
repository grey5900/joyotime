$(function(){$("#place-add-form").validate({rules:{placename:{required:!0},catelog:{required:!0},address:{minlength:4,required:!0},phone:{number:!0,required:!0},verifycode:{required:!0}},messages:{placename:{required:"请输入商家名称"},catelog:{required:"请选择商家类型"},address:{minlength:"请补充更详细的地址",required:"请输入商家地址"},phone:{number:"请输入正确的电话号码",required:"请输入商家电话"},verifycode:{required:"请输入验证码"}},highlight:function(n){n.type==="radio"?this.findByName(n.name).closest(".control-group").removeClass("valid success valid").addClass("error"):$(n).closest(".control-group").removeClass("valid success valid").addClass("error")},unhighlight:function(n){n.type==="radio"?this.findByName(n.name).closest(".control-group").removeClass("error success valid").addClass("valid"):$(n).closest(".control-group").removeClass("error success valid").addClass("valid")},success:function(n){n.type==="radio"?this.findByName(n.name).closest(".control-group").removeClass("error success valid").addClass("success"):$(n).closest(".control-group").removeClass("error success valid").addClass("success")},submitHandler:function(n){return $.ajax({type:"POST",url:$(n).attr("action"),data:$(n).serialize(),dataType:"json",success:function(n){n.code==1?$("#messager").messager({message:"商家登记成功，请等待管理员审核。"}):$("#messager").messager({message:"商家登记错误。"})}}),!1}}),$("#phone,#average").on("keyup",function(){$(this).val($(this).val().replace(/\D|^0/g,""))}).on("paste",function(){$(this).val($(this).val().replace(/\D|^0/g,""))}).css("ime-mode","disabled");var n=new soso.maps.Marker({position:new soso.maps.LatLng(30.6581,104.066),draggable:!0}),t=new soso.maps.Geocoder;$("#map").mapper({zoomLevel:12,marker:n,after:function(){soso.maps.Event.addListener(n,"dragend",function(){var i=n.getPosition();$("#coordinate").val(i),t.geocode({location:i},function(n,t){if(t==soso.maps.GeocoderStatus.OK){var i=n.addressComponents.district+n.addressComponents.streetNumber;$("#address").val(i)}})})}})})