!function(n){function r(t){this.input=t,n(t[0].form).submit(function(){t.hasClass("placeholder")&&t[0].value==t.attr("placeholder")&&(t[0].value="")})}var t=!1,i;n.signout=function(){n.ajax({type:"GET",url:"/signout/",dataType:"json",success:function(t){t.code==1?window.location.href="/":n("#messager").messager({message:t.msg})}})},n.is_signin=function(){if(online_id)return!0;var t=n("#signin-modal");return n.trim(t.html())==""?t.load("/show_form/signin/",function(n){t.html(n).modal("show"),t.find("input[placeholder], textarea[placeholder]").placeholder()}):t.modal("show"),!1},n.cookie=function(t,i,r){var h,o,s,f,u,e;if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(i))||i===null||i===undefined))return r=n.extend({},r),(i===null||i===undefined)&&(r.expires=-1),typeof r.expires=="number"&&(h=r.expires,o=r.expires=new Date,o.setDate(o.getDate()+h)),i=String(i),document.cookie=[encodeURIComponent(t),"=",r.raw?i:encodeURIComponent(i),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("");for(r=i||{},s=r.raw?function(n){return n}:decodeURIComponent,f=document.cookie.split("; "),u=0;e=f[u]&&f[u].split("=");u++)if(s(e[0])===t)return s(e[1]||"");return null},n.fn.emoji=function(){return this.each(function(){n(this).html(n(this).html().replace(/([\ue001-\ue537])/g,n.fn.emoji.replacer))})},n.fn.emoji.replacer=function(n,t){return t.charCodeAt(0).toString(16).toUpperCase().replace(/^([\da-f]+)$/i,'<img src="/emoji/emoji-$1.png" alt="emoji" />')},r.prototype={show:function(n){(this.input[0].value===""||n&&this.valueIsPlaceholder())&&(this.input.addClass("placeholder"),this.input[0].value=this.input.attr("placeholder"))},hide:function(){if(this.valueIsPlaceholder()&&this.input.hasClass("placeholder")&&(this.input.removeClass("placeholder"),this.input[0].value="",this.isPassword)){try{this.input[0].setAttribute("type","password")}catch(n){}this.input.show(),this.input[0].focus()}},valueIsPlaceholder:function(){return this.input[0].value==this.input.attr("placeholder")},handlePassword:function(){var t=this.input,i;t.attr("realType","password"),this.isPassword=!0,n.browser.msie&&t[0].outerHTML&&(i=n(t[0].outerHTML.replace(/type=(['"])?password\1/gi,"type=$1text$1")),this.fakePassword=i.val(t.attr("placeholder")).addClass("placeholder").focus(function(){t.trigger("focus"),n(this).hide()}),n(t[0].form).submit(function(){i.remove(),t.show()}))}},i=!!("placeholder"in document.createElement("input")),n.fn.placeholder=function(){return i?this:this.each(function(){var t=n(this),i=new r(t);i.show(!0),t.focus(function(){i.hide()}),t.blur(function(){i.show(!1)}),n.browser.msie&&(n(window).load(function(){t.val()&&t.removeClass("placeholder"),i.show(!0)}),t.focus(function(){if(this.value==""){var n=this.createTextRange();n.collapse(!0),n.moveStart("character",0),n.select()}}))})},n.fn.extend({returntop:function(){var t=n(this),i;t[0]||(t=n('<div id="returntop"></div>'),n("body").append(t)),i=t.click(function(){n("html, body").animate({scrollTop:0},120)}),n(window).bind("scroll",function(){var t=n(document).scrollTop(),r=n(window).height();200<t?i.fadeIn():i.fadeOut()})},messager:function(t){var i=n(this);i[0]||(i=n('<div id="messager"></div>'),n("body").append(i)),i.html(t.message);var o=n(document).scrollTop(),s=n(window).height(),h=n(window).width(),e=i.outerHeight(),u=i.outerWidth(),r=(s-e)/2+o,f=(h-u)/2;i.css({top:r+10,left:f,opacity:"0"}).animate({opacity:"1",top:r,queue:!0},200).delay(t.delay?t.delay:"3000").animate({opacity:"0",top:r+10,queue:!0},200,function(){i.remove(),t.refer&&(t.refer=="reload"?window.location.reload():window.location.href=t.refer)})},signinpop:function(){if(this[0]){var t=this;n(window).bind("scroll",function(){var i=n(document).scrollTop(),r=n(window).height();1e3<i?t.slideDown("fast"):t.slideUp("fast")})}},scrollLine:function(){var t;n("#con").hover(function(){clearInterval(t)},function(){t=setInterval(function(){var t=n("#con ul"),i=t.find("li:last").height();t.animate({marginTop:i+40+"px"},1e3,function(){t.find("li:last").prependTo(t),t.find("li:first").hide(),t.css({marginTop:0}),t.find("li:first").fadeIn(1e3)})},3e3)}).trigger("mouseleave")},displayFeedback:function(){if(this[0])var t=n(document).append('<div id="feedback"><div class=""></div></div>')},copy:function(){document.all?(window.clipboardData.setData("text",this.val()),alert("复制成功。")):alert("您的浏览器不支持剪贴板操作，请自行复制。")},close:function(t){var r=n("#"+t),i=n("#mask");r.hide(),i.hide()},pop:function(t){var u=n("#"+t),r=document.body.clientHeight,i=n(window).height(),o=n(window).width(),s=u.height(),f=u.width(),e=n(document).scrollTop();i>r&&(r=i),n("#mask").css({display:"block",height:r}),u.css({display:"block",top:(i-s)/2+e,left:(o-f)/2})},shake:function(){var i=n(this),t;for(box_left=(n(window).width()-i.outerWidth())/2,i.css({left:box_left,position:"absolute","margin-left":0}),t=1;4>=t;t++)i.animate({left:box_left-(4-t)},50),i.animate({left:box_left+2*(4-t)},50);return this},sound:function(n){var t=null;t?(document.body.removeChild(t),t.removed=!0,t=null,t=document.createElement("embed"),t.setAttribute("type","audio/mpeg"),t.setAttribute("hidden",!0),t.setAttribute("autostart",!0),t.setAttribute("src",n)):(t=document.createElement("embed"),t.setAttribute("type","audio/mpeg"),t.setAttribute("hidden",!0),t.setAttribute("autostart",!0),t.setAttribute("src",n)),t.removed=!1,document.body.appendChild(t)},phone_switch:function(t){function f(){i.animate({marginLeft:-u},1e3,function(){n(this).css({marginLeft:"0px"}).find("li:first").appendTo(this)})}var i=n("#"+t),u=i.find("li").outerWidth(!0),e=u*i.find("li").length,r;i.width(e),i.find("li").length>1&&(r=setInterval(f,4e3)),i.hover(function(){r&&clearInterval(r)},function(){clearInterval(r),r=setInterval(f,4e3)})},is_empty:function(){var t=n(this).first();return t.val()?!1:(t.focus(),!0)},charCount:function(t){function i(i){var u=n(i).val().length,r=t.allowed-u;r<=t.warning&&r>=0?n(i).next().addClass(t.cssWarning):n(i).next().removeClass(t.cssWarning),r<0?(r=0,n(i).val(n(i).val().substr(0,t.allowed)),n(i).next().addClass(t.cssExceeded)):n(i).next().removeClass(t.cssExceeded),n(i).next().html(t.counterText+r)}var r={allowed:140,warning:10,css:"counter",counterElement:"span",cssWarning:"warning",cssExceeded:"exceeded",counterText:""},t=n.extend(r,t);this.each(function(){n(this).after("<"+t.counterElement+' class="'+t.css+'">'+t.counterText+"</"+t.counterElement+">"),i(this),n(this).keyup(function(){i(this)}),n(this).change(function(){i(this)})})},plus:function(t){var i=n(this),r;i.first().html()==""?i.each(function(){n(this).html("("+t+")")}):(r=parseInt(i.first().html().replace("(","").replace(")","")),i.each(function(){n(this).html("("+(r+t)+")")}))},replyTo:function(t){var r=this,i=n("#reply_to_form");i[0]||(i=n('<form action="/review_reply" id="reply_to_form" method="post"><input type="hidden" value="0" name="rid" id="reply_rid" /><input type="hidden" id="reply_pid" value="0" name="pid"/><input name="content" maxlength="140" id="message" class="text" /><input type="submit" value="回复" class="btn btn-primary" /></form>')),i.hide(),r.closest("li").append(i),i.find("input[name='rid']").val(t.rid),t.pid!=""&&i.find("input[name='pid']").val(t.pid),i.find("input.text").val(""),i.slideDown("fast",function(){i.find("input.text").focus()})},replyDelete:function(){},lazyload:function(){var t=n(window).data("lazyloads");t||(t=[]),this.each(function(){t.push(this)}),n(window).data("lazyloads",t)},lazyshow:function(){return this.each(function(){var i=n(this),r=i.next();i.hasClass("loaded")||t!=!1||(t=!0,i.addClass("loading loaded"),n.ajax({url:i.attr("href"),type:"get",dataType:"html",success:function(u){r.append(u).masonry("reload").animate({opacity:1},function(){n('[data-spy="scroll"]').scrollspy("refresh")}).find(".timeline-column").each(function(){var t=n(this).css("left");t=="0px"?(html="<i class='friangle-lt'></i>",n(this).find(".feed").prepend(html)):(html="<i class='friangle-rt'></i>",n(this).find(".feed").prepend(html))}),i.removeClass("loading"),t=!1},error:function(){i.removeClass("loading loaded"),t=!1}}))})}})}(window.jQuery),$(function(){$("input[placeholder], textarea[placeholder]").placeholder(),$("input[type=text]").addClass("text-input"),$("input[type=password]").addClass("text-input"),$(".list-reply li:odd").addClass("odd"),$(".list-reply li:even").addClass("even");$("#signin-modal").on("submit",function(){var n=$(this),t=n.find("input[type=submit]");return t.button("loading"),$.ajax({type:"POST",url:n.attr("action"),data:n.serialize(),dataType:"json",success:function(i){i.code==1?(n.modal("hide"),window.location.reload()):alert(i.msg),t.button("reset")},error:function(){alert("登录失败，请重试。"),t.button("reset")}}),!1})})