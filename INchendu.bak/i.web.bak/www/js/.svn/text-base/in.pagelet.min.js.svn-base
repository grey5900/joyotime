!function(n){n(function(){var i=n("#mini-header"),r=n("#mini-header").length&&n("#mini-header").offset().top,t=0;n(window).on("scroll",function(){var f,u=n(window).scrollTop();u>=r&&!t?(t=1,i.addClass("fixed")):u<=r&&t&&(t=0,i.removeClass("fixed"))});n(".badge_list a").on("click",function(){link=n(this),n("#console_container").find("> .active").removeClass("active"),link.parent("li").addClass("active"),n(".badge_detail > .photo img").attr({src:link.attr("data-photo")}),n(".badge_detail > h3").text(link.attr("data-title")),n(".badge_detail > .intro").text(link.attr("data-intro")),n(".badge_detail > .time").text(link.attr("data-time"))});n('.btn.favorite[disabled!="disabled"]').on("click",function(){var t=n(this);if(n.is_signin())n.ajax({type:"POST",url:"/favorite/",data:{id:t.attr("date-id"),type:t.attr("date-target")},async:!1,cache:!1,dataType:"json",success:function(i){i.code!=1?n("#messager").messager({message:i.msg}):t.text("已收藏").removeClass("favorite btn-primary").addClass("favorited disabled").off()}});else return!1;return!1});n('.btn.follow[disabled!="disabled"]').live("click",function(){var t=n(this);if(n.is_signin())t.button("loading"),n.ajax({type:"POST",url:"/do_follow/",data:"bf="+t.attr("data-id")+"&do="+t.attr("data-action"),dataType:"json",success:function(i){return t.button("reset"),n("#messager").messager({message:i.msg}),i.code==1&&t.text("取消关注").attr("data-action","uf").removeClass("btn-primary follow").addClass("followed"),!1}});else return!1}),n('.btn.followed[disabled!="disabled"]').live("click",function(){var t=n(this);if(n.is_signin())t.button("loading"),n.ajax({type:"POST",url:"/do_follow/",data:"bf="+t.attr("data-id")+"&do="+t.attr("data-action"),dataType:"json",success:function(i){return t.button("reset"),n("#messager").messager({message:i.msg}),i.code==1&&t.text("加关注").attr("data-action","f").removeClass("followed").addClass("btn-primary follow"),!1}});else return!1});n(".setmnemonic").on("click",function(){var i=n(this),t=n("#user-setmnemonic-form"),r=n("#user_mnemonic");t.data("id",i.data("id")),r.val(i.data("mnemonic")),t.modal("show")});n("#user-setmnemonic-form").on("submit",function(){var t=n(this),i=n("#u_"+t.data("id")).find(".username");return n.ajax({url:t.attr("action")+"/"+t.data("id")+"/",type:"post",dataType:"json",data:t.serialize(),success:function(r){return(r.code=1)?(n("#user_mnemonic").val()?i.each(function(){n(this).find("a").text(n("#user_mnemonic").val())}):window.location.reload(),n("#user_mnemonic").val(""),t.modal("hide")):n("#messager").messager({msg:r.msg}),!1}}),!1})})}(window.jQuery)